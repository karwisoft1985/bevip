<html>
<head>
   <title>Bevip</title>
   <!-- style pour le navigation scrollable  -->
    <link rel="stylesheet" href="assets/css/scrollmenu.css">

    
       
		<link rel="stylesheet" type="text/css" href="assets/css/index.css">
		<link rel="stylesheet" type="text/css" href="assets/css/font.css">
		<link rel="stylesheet" type="text/css" href="assets/css/font-awesome.css">
		<link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css">
		<link type="text/css" rel="stylesheet" href="assets/css/demo.css" />
		<link type="text/css" rel="stylesheet" href="assets/css/jquery.mmenu.all.css" />
		<link rel="stylesheet" type="text/css" href="main.css" media="all" />
		<link rel="stylesheet" type="text/css" href="cb_style.css" media="all" />
	    <link rel="stylesheet" type="text/css" href="assets/css/font-awesome.css">
        <script src="cordova.js"></script>
		<script type="text/javascript" src="assets/js/jquery.min.js"></script>
		<script src="js_web_service/login/info_connect.js"></script>
		<script src="js_web_service/login/check_cnx.js"></script>
		
    <!--<script type="text/javascript" charset="utf-8" src="assets/js/jquery.mobile-1.3.1.js"></script>-->
	<script src="js_web_service/main/notif_msg.js"></script>
<script>

	  function playbot() {
	   db.transaction(function(tx) {tx.executeSql("select lang from utilisateur where id_utilisateur='1'", [] ,
		
								function(tx, result) {

                                dataset = result.rows;
								
								item = dataset.item(0);
								
								var lang = item['lang']; 
        var u = new SpeechSynthesisUtterance();
        var x = document.getElementById("frm2");
        var txt = "";
        txt = x.elements[0].value
        u.text = txt;
		if(lang=='fr'){
        u.lang = 'fr-FR';}
        else{u.lang = 'en-US';}
        speechSynthesis.speak(u);   
	  });
	  });
      }
 $(window).bind('beforeunload', function(event) {   
 speechSynthesis.cancel();
 });
 document.addEventListener("resume", onResume, false);
function onResume() {
   speechSynthesis.cancel();
}
   </script>
   			 <script>
			   var db = openDatabase("bevip", "1.0", "bevip", 200000);
       var dataset;
       var DataType;
 function placeholders() {
db.transaction(function(tx) {tx.executeSql("select lang from utilisateur where id_utilisateur='1'", [] ,
		
								function(tx, result) {

                                dataset = result.rows;
								
								item = dataset.item(0);
								
								var lang = item['lang'];
if(lang=="fr"){
  document.querySelector("input[type=text]")
  .setAttribute("placeholder", "Partenaires, projets, et plus...");}
   else if (lang == 'ar'){
	 document.querySelector("input[type=text]")
  .setAttribute("placeholder", "...شركاء، مشاريع، و المزيد");
}
					 else {
				 document.querySelector("input[type=text]")
  .setAttribute("placeholder", "Partners, projects, and more..");
        }
});  
});  
}

$(document).ready(placeholders);

	 </script> 	
		<script type="text/javascript">
		
			$(function() {
				$('nav#menu').mmenu({
					extensions	: [ 'effect-slide-menu', 'shadow-page', 'shadow-panels' ],
					counters	: true,
					navbar 		: {
						title		: '<img src="assets/img/logo.png" id="logo" style="width:70px;margin-right:5px;"/> '
					},
					navbars		: [
						{
							position	: 'top',
							content		: [
								'prev',
								'title',
								'close'
							]
						}
					]
				});
			});
			
			
		</script>
    <style type="text/css">
    
      .leftside {
        display:block;
		text-align:center;
      }
      .rightside {
        display:block;
		text-align:center;
      }
      .centerthis {
        width: 90%;
      }
      #chatdiv {
        margin-top: 20px;
        text-align: center;
        width: 100%;
      }
     
    </style>
	<script src='https://code.responsivevoice.org/responsivevoice.js'></script>
	   
	    <!-- fin appel fichier sqlite pour la création de la base de données local  -->
	 <script>
function goBack() {
    window.history.back();
}

</script>
</head> 
<body   class="bodybot"> 


<div id="element" class="introLoading"></div>
<div class="header-bvp">
	<div class="left-header-bvp" >

		
		
		<span onclick="goBack()" style="margin-right:20px;"><i class="fa fa-arrow-left" aria-hidden="true" style="color:#fff; font-size:20px" ></i></span>
<span style="display:none">
 <input type="text" class="mm-search" name="partenaire" id="partenaire" onchange="rechercher();"  style=" background-color: #0099cc; color: #fff; border: none; width:78%"  />
 <i class="fa fa-search" style="color:#fff; font-size:18px" onclick="rechercher();"></i>
</span>						
	</div>			
	</div>
				<!-- debut bloc menu de navigation -->	
		
  
        <div class="nav-bar-bvp" >			     
				 
				 <a href="actualite.html">
				 <li >
				     <i class="fa fa-home" aria-hidden="true" style="color:#ff5722;font-size:30px;"></i><br>
					 <span id='actualite'></span>
					 
				 </li>
				 </a>
				 
				 
				  <a href="store.html">
				  
				  <li>
				     
					 
					  <i class="fa fa-shopping-bag" aria-hidden="true"  style="color:#ff5722;font-size:30px;"></i><br>
					<span id='project'></span>
					 
				 
				  </li>
				  
				  </a> 
				  
				 <a href="tasks.html">
				 
				 <li>
				     
					 
					 <i class="fa fa-tasks" aria-hidden="true" style="color:#ff5722;font-size:30px;"></i><br>
					 <span id='tasks'></span>
					 
				 
				 </li>
				 
				 </a>
				 
				 <a href="statistics.html">
				 
				 <li>
				     
					 
					 <i class="fa fa-signal"  aria-hidden="true" style="color:#ff5722;font-size:30px;"></i><br>
					 <span id='statistics'></span>
					 
				 
				 </li>
				 
				 </a>
				  
				<a href="support.html">
					<li>
				    <i class="fa fa-shopping-cart" aria-hidden="true" style="color:#ff5722;font-size:30px;"></i><br>
					<span id='partner'></span>					 				 
					</li>
					</a>
        </div>
<div id="msg-err-cnx">		
<!-- fin bloc menu de navigation -->	
<center><h5 id="msg"></h5></center>


<h1 style="text-align:center;"><span id='talk'></span></h1>
<form id="frm1">
<input id="text" hidden ="hidden">
 </form> 
 <form id="frm2">
<input id="textbot" hidden="hidden" >
 </form> 
       
	<!--	<button >Voice</button> -->
		<!--<button onclick="playVibrate();" >Make me talk!</button>-->
		
		
<div class="centerthis">
     <br>
	   
	   
	 <div style="text-align:center;">
	<span id="answer"></span>
	 <span id="next_qst"></span>
	 
	 </div>
	 <br>
      <div class="rightside">
      <div class="manspeech">
	        
        <div  class="triangle-border bottom blue">
         <div id="question"></div>
        </div>
      </div>
	   <form method="post" name="talkform" id="talkform" action="">
	   <div style="display:none">
	   <input type="text" name="say" id="say" />
	   <input type="submit" name="submit" id="submit"  value="SAY" />
	   </div>
	   </form>
	       <img src="bot.gif" style="width:200px;" />
      
      </div>

</div>
  

  
  
  <form onsubmit="sendMessage();" id="messageForm"> 
  
					   <div class="bottom_send" >
						    
							<div class="bottom_send_group_textarea" style="padding-right:10px;padding-left:10px;width:90%;"> 
							
							</div>
							<div style="background:#127439;padding:10px;color:#fff;"  onclick="other()">
							
						     <span id="other"></span>
							
							</div>
							 
							 
							  
						</div>
	
	</form>
		  </div>  
    <script type="text/javascript" src="jquery-1.9.1.min.js"></script>
	
    <script type="text/javascript">
	  $(document).ready(function(){
	   var contenuHtml1='';
 var contenuHtml2='';
 var contenuHtml3='';
 var contenuHtml4='';
 var contenuHtml5='';
 var contenuHtml6='';
 var contenuHtml7='';
 var contenuHtml8='';
 var contenuHtml9='';
 var contenuHtml10='';
	  db.transaction(function(tx) {tx.executeSql("select lang from utilisateur where id_utilisateur='1'", [] ,
		
								function(tx, result) {

                                dataset = result.rows;
								
								item = dataset.item(0);
								
								var lang = item['lang']; 
								var dataString='lang='+lang;
								$.getJSON("http://karwisoft.tn/php_bevip/chatbot/questions.php",dataString,
								function (donnees) {
								if (lang=='fr'){
								document.getElementById("question").innerHTML = 'Voulez-vous savoir '+donnees.questions[0].question+'?';}
								else{
								document.getElementById("question").innerHTML = 'Do you want to know '+donnees.questions[0].question+'?';}
								document.getElementById("say").value=donnees.questions[0].question;
								});
			if(lang=="fr"){
				         contenuHtml1 += 'Tâches';
				         contenuHtml2 += 'Projets';
				         contenuHtml3 += 'Statistiques';
				         contenuHtml4 += 'Parler';
				         contenuHtml5 += 'A la une';
				         contenuHtml6 += 'Partenaires';
				         contenuHtml7 += '&ldquo;Appelle une bonne habitude pour en chasser une mauvaise, mais appelle-la deux fois&rdquo;';
				         contenuHtml8 += ' <button style="padding:10px;margin:5px;display:inline;color:#fff;font-size:16px;text-transformation:uppercase;background:#127439;border:none" onclick="answer();">Réponds-moi</button>';
				         contenuHtml9 += '<button style="padding:10px;margin:5px;display:inline;color:#fff;font-size:16px;text-transformation:uppercase;background:#c32929;border:none" onclick="other()">Question suivante</button>';
				         contenuHtml10 += '<button style="z-index: 99;background: none;font-size:18px;margin-top:2%;border:none;">OK, autre </button>';
					}
					 else if (lang == 'ar'){
				    contenuHtml1 += 'مهام';	
				    contenuHtml2 += 'مشاريع';	
				    contenuHtml3 += 'إحصائيات';	
				    contenuHtml4 += 'تحدث';	
				    contenuHtml5 += 'أخبار';	
				    contenuHtml6 += 'شركاء';	
				    contenuHtml7 += '&rdquo;العادات الجيدة هي مفتاح النجاح. العادات السيئة هي بوابة الفشل&ldquo;';	
					contenuHtml8 += ' <button style="padding:10px;margin:5px;display:inline;color:#fff;font-size:16px;text-transformation:uppercase;background:#127439;border:none" onclick="answer();">Answer me</button>';
				    contenuHtml9 += '<button style="padding:10px;margin:5px;display:inline;color:#fff;font-size:16px;text-transformation:uppercase;background:#c32929;border:none" onclick="other()"> Next question </button>';
				    contenuHtml10 += '<button style="z-index: 99;background: none;font-size:18px;margin-top:2%;border:none;">OK, other </button>';
					 }
					 else {
				    contenuHtml1 += 'Tasks';
				    contenuHtml2 += 'Projects';
				    contenuHtml3 += 'Statistics';
				    contenuHtml4 += 'Talk';
				    contenuHtml5 += 'News';
				    contenuHtml6 += 'Partners';
				    contenuHtml7 += '&ldquo;Good habits are the key to all success. Bad habits are the unlocked door to failure&rdquo;';
					contenuHtml8 += ' <button style="padding:10px;margin:5px;display:inline;color:#fff;font-size:16px;text-transformation:uppercase;background:#127439;border:none" onclick="answer();">Answer me</button>';
				    contenuHtml9 += '<button style="padding:10px;margin:5px;display:inline;color:#fff;font-size:16px;text-transformation:uppercase;background:#c32929;border:none" onclick="other()"> Next question </button>';
				    contenuHtml10 += '<button style="z-index: 99;background: none;font-size:18px;margin-top:2%;border:none;">OK, other</button>';
					}
 document.getElementById("tasks").innerHTML = contenuHtml1;
 document.getElementById("project").innerHTML = contenuHtml2;
 document.getElementById("statistics").innerHTML = contenuHtml3;
 document.getElementById("actualite").innerHTML = contenuHtml5;
 document.getElementById("partner").innerHTML = contenuHtml6;
document.getElementById("answer").innerHTML = contenuHtml8;
 document.getElementById("next_qst").innerHTML = contenuHtml9;
 document.getElementById("other").innerHTML = contenuHtml10;
	  });
	  });
	  });

function answer(){
document.getElementById('submit').click();
}
function other(){
 db.transaction(function(tx) {tx.executeSql("select lang from utilisateur where id_utilisateur='1'", [] ,
		
								function(tx, result) {

                                dataset = result.rows;
								
								item = dataset.item(0);
								
								var lang = item['lang']; 
var dataString='lang='+lang;
$.getJSON("http://karwisoft.tn/php_bevip/chatbot/questions.php",dataString,
        function (donnees) {
		if(lang=='fr'){
		document.getElementById("question").innerHTML = 'Voulez-vous savoir '+donnees.questions[0].question+'?';}
		else{
		document.getElementById("question").innerHTML = 'Do you want to know '+donnees.questions[0].question+'?';}
		document.getElementById("say").value=donnees.questions[0].question;
});
});
});
}
	 </script> 
	 <script type="text/javascript">
	  $(document).ready(function(){
      // put all your jQuery goodness in here.
        $('#talkform').submit(function(e) {
          e.preventDefault();
          var user = $('#say').val(); 
          $('.usersay').text(user);
		  document.getElementById("text").value = user; 
          var formdata = $("#talkform").serialize();
          $('#say').val('');
          $('#say').focus();
          $.get('http://karwisoft.tn/php_bevip/chatbot/conversation_start.php', formdata, function(data){
            var b = data.botsay;
            if (b.indexOf('[img]') >= 0) {
              b = showImg(b);
            }
            if (b.indexOf('[link') >= 0) {
              b = makeLink(b);
            }
            var usersay = data.usersay;
            if (user != usersay) {
              $('.usersay').text(usersay);
            }
            $('.bottom_send_group_textarea').html(b);
			 document.getElementById("textbot").value = b; 
			 		  playbot();

          }, 'json').fail(function(xhr, textStatus, errorThrown){
            $('#urlwarning').html("Something went wrong! Error = " + errorThrown);
          });
          return false;
        });
      });
	  
      function showImg(input) {
        var regEx = /\[img\](.*?)\[\/img\]/;
        var repl = '<br><a href="$1" target="_blank"><img src="$1" alt="$1" width="150" /></a>';
        var out = input.replace(regEx, repl);
        console.log('out = ' + out);
        return out
      }
	  
      function makeLink(input) {
        var regEx = /\[link=(.*?)\](.*?)\[\/link\]/;
        var repl = '<a href="$1" target="_blank">$2</a>';
        var out = input.replace(regEx, repl);
        console.log('out = ' + out);
        return out;
      }
	</script>
</body> 
<html>